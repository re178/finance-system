<!DOCTYPE html>
<html>
<head>
  <title>Expenses</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <h2>Expense Management</h2>
</header>

<div class="container">
  <form id="expenseForm">
    <input id="amount" type="number" placeholder="Amount" required>
    <input id="category" placeholder="Category (Food, Rent)" required>
    <button>Add Expense</button>
  </form>

  <table>
    <thead>
      <tr>
        <th>Amount</th>
        <th>Category</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="list"></tbody>
  </table>
</div>

<script>
async function load() {
  const res = await fetch("/transactions");
  const data = await res.json();
  document.getElementById("list").innerHTML = data
    .filter(t => t.type === "expense")
    .map(t => `
      <tr>
        <td>${t.amount}</td>
        <td>${t.category}</td>
        <td>
          <button class="danger" onclick="del(${t.id})">Delete</button>
        </td>
      </tr>
    `).join("");
}

document.getElementById("expenseForm").onsubmit = async e => {
  e.preventDefault();
  await fetch("/add-transaction", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({
      type: "expense",
      amount: amount.value,
      category: category.value
    })
  });
  load();
};

async function del(id) {
  await fetch("/delete/" + id, { method: "DELETE" });
  load();
}

load();
</script>

</body>
</html>
