<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <h1>FINANCIAL DASHBOARD</h1>
</header>

<div class="container">
<div id="summary" style="margin-bottom:20px;"></div>

  <div id="info"></div>

  <table border="1" width="100%">
    <tr>
      <th>Type</th>
      <th>Amount</th>
      <th>Category</th>
      <th>Actions</th>
    </tr>
    <tbody id="list"></tbody>
  </table>

  <br>
  <button onclick="logout()">Logout</button>

</div>

<script>
// üîê AUTH CHECK
let user = JSON.parse(localStorage.getItem("user"));
if (!user) window.location.href = "/login.html";

// üë§ USER INFO
document.getElementById("info").innerHTML =
  `<h3>Welcome, ${user.username}</h3>
   <p>Role: ${user.role}</p>`;

// üì• LOAD TRANSACTIONS
async function load() {
  let res = await fetch("/transactions");
  let data = await res.json();
  let list = document.getElementById("list");
  list.innerHTML = "";

  data.forEach(t => {
    list.innerHTML += `
      <tr>
        <td>${t.type}</td>
        <td>${t.amount}</td>
        <td>${t.category}</td>
        <td>
          <button class="danger" onclick="del(${t.id})">Delete</button>
        </td>
      </tr>`;
  });
}

// üóë DELETE TRANSACTION
async function del(id) {
  await fetch("/delete/" + id, { method: "DELETE" });
  load();
}
async function loadSummary() {
  const res = await fetch("/summary"); // call backend
  const data = await res.json();

  document.getElementById("summary").innerHTML = `
    <h3>Financial Summary</h3>
    <p>Total Income: $${data.income}</p>
    <p>Total Expenses: $${data.expense}</p>
    <p>Balance: $${data.balance}</p>
  `;
}

// üö™ LOGOUT
function logout() {
  localStorage.removeItem("user");
  window.location.href = "/login.html";
}

// ‚ñ∂ START
load();
</script>

</body>
</html>


